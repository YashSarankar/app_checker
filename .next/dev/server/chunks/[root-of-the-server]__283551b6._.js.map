{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 280, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yashs/development/app_checker/src/app/api/keywords/route.js"],"sourcesContent":["import gplay from 'google-play-scraper';\r\nimport { NextResponse } from 'next/server';\r\n\r\nexport async function POST(request) {\r\n    try {\r\n        const { appId, term, country = 'us', lang = 'en' } = await request.json();\r\n\r\n        if (!appId || !term) {\r\n            return NextResponse.json({ error: 'appId and term are required' }, { status: 400 });\r\n        }\r\n\r\n        // Quantum Depth Logic: Patched to search up to 1000 positions\r\n        let finalPosition = '1000+';\r\n        let foundRegion = null;\r\n        let isDeepFound = false;\r\n\r\n        const primaryResults = await gplay.search({\r\n            term,\r\n            num: 1000, // Patched core to allow this\r\n            country,\r\n            lang\r\n        });\r\n\r\n        const pos = primaryResults.findIndex(item => item.appId === appId) + 1;\r\n\r\n        if (pos > 0) {\r\n            finalPosition = pos;\r\n            foundRegion = country;\r\n            isDeepFound = true;\r\n        } else {\r\n            // Niche Permutation Scan: If invisible in Top 1000, find the closest entry point\r\n            const niches = [`${term} app`, `best ${term}`, `${term} manager`, `${term} tracker`].slice(0, 3);\r\n            for (const niche of niches) {\r\n                try {\r\n                    const results = await gplay.search({ term: niche, num: 250, country, lang });\r\n                    const p = results.findIndex(item => item.appId === appId) + 1;\r\n                    if (p > 0) {\r\n                        finalPosition = `#${p} (found via \"${niche}\")`;\r\n                        foundRegion = country;\r\n                        isDeepFound = true;\r\n                        break;\r\n                    }\r\n                } catch (e) { }\r\n            }\r\n        }\r\n\r\n        return NextResponse.json({\r\n            term,\r\n            position: finalPosition,\r\n            region: foundRegion,\r\n            isQuantumScan: !isDeepFound,\r\n            timestamp: new Date().toISOString()\r\n        });\r\n    } catch (error) {\r\n        console.error('Keyword error:', error);\r\n        return NextResponse.json({ error: 'Failed to find ranking' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAO;IAC9B,IAAI;QACA,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,UAAU,IAAI,EAAE,OAAO,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEvE,IAAI,CAAC,SAAS,CAAC,MAAM;YACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA8B,GAAG;gBAAE,QAAQ;YAAI;QACrF;QAEA,8DAA8D;QAC9D,IAAI,gBAAgB;QACpB,IAAI,cAAc;QAClB,IAAI,cAAc;QAElB,MAAM,iBAAiB,MAAM,+JAAK,CAAC,MAAM,CAAC;YACtC;YACA,KAAK;YACL;YACA;QACJ;QAEA,MAAM,MAAM,eAAe,SAAS,CAAC,CAAA,OAAQ,KAAK,KAAK,KAAK,SAAS;QAErE,IAAI,MAAM,GAAG;YACT,gBAAgB;YAChB,cAAc;YACd,cAAc;QAClB,OAAO;YACH,iFAAiF;YACjF,MAAM,SAAS;gBAAC,GAAG,KAAK,IAAI,CAAC;gBAAE,CAAC,KAAK,EAAE,MAAM;gBAAE,GAAG,KAAK,QAAQ,CAAC;gBAAE,GAAG,KAAK,QAAQ,CAAC;aAAC,CAAC,KAAK,CAAC,GAAG;YAC9F,KAAK,MAAM,SAAS,OAAQ;gBACxB,IAAI;oBACA,MAAM,UAAU,MAAM,+JAAK,CAAC,MAAM,CAAC;wBAAE,MAAM;wBAAO,KAAK;wBAAK;wBAAS;oBAAK;oBAC1E,MAAM,IAAI,QAAQ,SAAS,CAAC,CAAA,OAAQ,KAAK,KAAK,KAAK,SAAS;oBAC5D,IAAI,IAAI,GAAG;wBACP,gBAAgB,CAAC,CAAC,EAAE,EAAE,aAAa,EAAE,MAAM,EAAE,CAAC;wBAC9C,cAAc;wBACd,cAAc;wBACd;oBACJ;gBACJ,EAAE,OAAO,GAAG,CAAE;YAClB;QACJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB;YACA,UAAU;YACV,QAAQ;YACR,eAAe,CAAC;YAChB,WAAW,IAAI,OAAO,WAAW;QACrC;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,kBAAkB;QAChC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAyB,GAAG;YAAE,QAAQ;QAAI;IAChF;AACJ"}}]
}